[
  {
    "Id": "499227",
    "ThreadId": "228787",
    "Html": "<p>Hi All,</p>\r\n<p>I created an excel file using excel mobile with a device with windows mobile 5.0. &nbsp;When I use the method AsDataSet does not return any datatable, there is no errors. &nbsp;The code that i'm using is:</p>\r\n<p>&nbsp;</p>\r\n<p>FileStream stream = File.Open(@&quot;\\My Documents\\Personal\\test.xls&quot;, FileMode.Open, FileAccess.Read); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>IExcelDataReader excelReader = ExcelReaderFactory.CreateBinaryReader(stream);&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>excelReader.IsFirstRowAsColumnNames = true;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>DataSet result = excelReader.AsDataSet();&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>if (result.Tables.Count &gt; 0)&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>if (result.Tables[&quot;Sheet1&quot;].Rows.Count &gt; 0)&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>&nbsp;InventoryGridInfo gridInfo;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>&nbsp;foreach (DataRow row in result.Tables[&quot;Sheet1&quot;].Rows)&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>gridInfo = new InventoryGridInfo();&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>foreach (DataColumn column in result.Tables[&quot;Sheet1&quot;].Columns)&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>SetData(gridInfo, column.ColumnName, row[column.ColumnName]);&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>inventoryGridCollection.Add(gridInfo);&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</p>\r\n<p>excelReader.Close();</p>\r\n<p>&nbsp;</p>\r\n<p>When I debug my application, i can see that the file was opened succesfully, because the length of the stream is grater than 0.</p>\r\n<p>Regards...</p>",
    "PostedDate": "2010-09-27T17:40:54.397-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]