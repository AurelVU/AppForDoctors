[
  {
    "Id": "1142344",
    "ThreadId": "478036",
    "Html": "I love this tool, as by converting Excel file of any type into DataTables in a DataSet, Excel becomes transparent to the user. In my application, this makes life easy.\r<br />\nI made a short working C# demo that I post here. \r<br />\n<br />\nMake a new Project, add a DataGridView and run the demo with either xls or xlsx file. <br />\n<pre><code>using System.Data;\nusing System.Windows.Forms;\nusing System.IO;\nusing Excel;\n\nnamespace ExcelDataReader\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n            displayDataGrid(getDataSet());\n        }\n\n        public DataSet dataSet = new DataSet();\n\n        public DataSet getDataSet()\n        {\n            // Get the Excel file and convert to dataset \n            OpenFileDialog fileDialog = new OpenFileDialog();\n            DialogResult result = fileDialog.ShowDialog();\n            FileStream stream = File.Open(fileDialog.FileName, FileMode.Open, FileAccess.Read);\n            if (fileDialog.FileName.EndsWith(&quot;xls&quot;))\n                dataSet = readExcel2003(stream);\n            if (fileDialog.FileName.EndsWith(&quot;xlsx&quot;))\n                dataSet = readExcelXML(stream);\n            return dataSet;\n        }\n\n        public DataSet readExcelXML(FileStream stream)\n        {\n            //2. Reading from a OpenXml Excel file (2007 format; *.xlsx)\n            IExcelDataReader excelReader = ExcelReaderFactory.CreateOpenXmlReader(stream);\n            dataSet = excelReader.AsDataSet();\n            excelReader.Close();\n            return dataSet;\n        }\n\n        public DataSet readExcel2003(FileStream stream)\n        {\n            //1. Reading from a binary Excel file ('97-2003 format; *.xls)\n            IExcelDataReader excelReader = ExcelReaderFactory.CreateBinaryReader(stream);\n            dataSet = excelReader.AsDataSet();\n            excelReader.Close();\n            return dataSet;\n        }\n\n        public void displayDataGrid(DataSet dataSet)\n        {\n            dataGridView1.DataSource = dataSet.Tables[1];\n            dataGridView1.Show();\n\n        }\n    }\n}\n</code></pre>\n\n",
    "PostedDate": "2013-12-26T07:15:54.703-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]