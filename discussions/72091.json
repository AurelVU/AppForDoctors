[
  {
    "Id": "246017",
    "ThreadId": "72091",
    "Html": "<p>Thanks for the great component!</p>\r\n<p>Does the latest version (2.0.1.0) supports Excel 2007&nbsp; (xlsx) files?<br>It works well for my Excel 97-2003 files, but returns nothing for Excel 2007 (DataSet with 0 tables).</p>\r\n<p>Here's the code:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">Dim</span> stream <span style=\"color:Blue\">As</span> FileStream = File.Open(strFileName, FileMode.Open, FileAccess.Read)<br><span style=\"color:Blue\">Dim</span> excelReader <span style=\"color:Blue\">As</span> IExcelDataReader<br><span style=\"color:Blue\">If</span> strFileName.Substring(strFileName.LastIndexOf(<span style=\"color:#A31515\">&quot;.&quot;</span>c) + 1).ToLower = <span style=\"color:#A31515\">&quot;xls&quot;</span> <span style=\"color:Blue\">Then</span><br>   excelReader = ExcelReaderFactory.CreateBinaryReader(stream)<br><span style=\"color:Blue\">ElseIf</span> strFileName.Substring(strFileName.LastIndexOf(<span style=\"color:#A31515\">&quot;.&quot;</span>c) + 1).ToLower = <span style=\"color:#A31515\">&quot;xlsx&quot;</span> <span style=\"color:Blue\">Then</span><br>   excelReader = ExcelReaderFactory.CreateOpenXmlReader(stream)<br><span style=\"color:Blue\">End</span> <span style=\"color:Blue\">If</span><br><br><span style=\"color:Blue\">Try</span><br>    <span style=\"color:Blue\">Dim</span> ds <span style=\"color:Blue\">As</span> DataSet = excelReader.AsDataSet<br>    <span style=\"color:Blue\">For</span> <span style=\"color:Blue\">Each</span> dt <span style=\"color:Blue\">As</span> DataTable <span style=\"color:Blue\">In</span> ds.Tables<br>        <span style=\"color:Blue\">For</span> <span style=\"color:Blue\">Each</span> row <span style=\"color:Blue\">As</span> DataRow <span style=\"color:Blue\">In</span> dt.Rows<br>            <span style=\"color:Blue\">Dim</span> res <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">String</span> = <span style=\"color:Blue\">String</span>.Empty<br>            <span style=\"color:Blue\">For</span> i <span style=\"color:Blue\">As</span> Int32 = 0 <span style=\"color:Blue\">To</span> row.ItemArray.Length - 1<br>                res &amp;= <span style=\"color:#A31515\">&nbsp;</span><span style=\"color:Blue\">String</span>.Format(<span style=\"color:#A31515\">&quot;{0}&quot;</span>, row.ItemArray(i))<br>            <span style=\"color:Blue\">Next</span><br><br>            <span style=\"color:Green\">' do something with res</span><br><br>        <span style=\"color:Blue\">Next</span><br>     <span style=\"color:Blue\">Next</span><br><br>     excelReader.Close()<br>     File.Delete(strFileName)<br></pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>Any Excel 2007 working code sample (vb or c#) would be highly appreciated.</p>\r\n<p>Thanks in advance!<br>eyal</p>\r\n<p>&nbsp;</p>\r\n<p>UPDATE: The problem seems to derive from an Excel 2007 file with a single worksheet. I ran this code with another Excel 2007 file, which has 3 worksheets (2 are empty), and it works fine. Any suggestions on how to load an Excel 2007 file with only 1 worksheet?</p>",
    "PostedDate": "2009-10-15T06:27:11.43-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]