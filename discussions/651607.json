[
  {
    "Id": "1463947",
    "ThreadId": "651607",
    "Html": "Hello to all, I made it my program read the excel and only let the filled rows in a DataTable like this code:<br />\n<pre><code>using System;\nusing System.Data;\nusing System.IO;\nusing Excel;\nusing System.Windows.Forms;\n\nnamespace SambaNet.ConversaoPlanilhaExcel.Classes\n{\n    public class LerPlanilha\n    {\n        IExcelDataReader excelReader = null;\n        FileStream stream = null;\n        public string tipo { get; set; }\n        public string filePath { get; set; }\n        bool erro = false;\n        DataSet ds = null;\n        DataTable dt = null;\n\n        //RETORNA UMA DATATABLE COM A SHEET ESCOLHIDA, NO CASO A 1 - Produtos\n        public DataTable Ler()\n        {\n            string extension = Path.GetExtension(filePath);\n            try\n            {\n                stream = File.Open(filePath, FileMode.Open, FileAccess.Read);\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.Message);\n                erro = true;\n            }\n            if (!erro)\n            {\n                switch (extension)\n                {\n                    case &quot;.xls&quot;:\n                        excelReader = ExcelReaderFactory.CreateBinaryReader(stream);\n                        break;\n                    case &quot;.xlsx&quot;:\n                        excelReader = ExcelReaderFactory.CreateOpenXmlReader(stream);\n                        break;\n                }\n\n                excelReader.IsFirstRowAsColumnNames = true;\n                ds = excelReader.AsDataSet();\n                dt = ds.Tables[1];\n                dt = RemoverRows(dt);\n                FecharConexao();\n                return dt;\n            }\n            else\n            {\n                FecharConexao();\n                return null;\n            }\n        }\n\n        //RETORNA A DATATABLE SEM AS ROWS VAZIAS.\n        public DataTable RemoverRows(DataTable dt)\n        {\n            int columnCount = dt.Columns.Count;\n\n            for (int i = dt.Rows.Count - 1; i &gt;= 0; i--)\n            {\n                bool allNull = true;\n                for (int j = 0; j &lt; columnCount; j++)\n                {\n                    if (dt.Rows[i][j] != DBNull.Value)\n                    {\n                        allNull = false;\n                    }\n                }\n                if (allNull)\n                {\n                    dt.Rows[i].Delete();\n                }\n            }\n            dt.AcceptChanges();\n            return dt;\n        }\n\n        public void FecharConexao()\n        {\n            excelReader.Close();\n        }\n    }\n}</code></pre>\n\nNow, I would like to make a filter system, for example:<br />\n<ul>\n<li>If my id is duplicated, send a message.</li>\n<li>\nIf my description contains special characters, send a warning.<br />\n</li>\n</ul>\nHow could I develop it? Thank you, I enjoyed this reader!<br />\n",
    "PostedDate": "2016-02-22T04:47:59.997-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]