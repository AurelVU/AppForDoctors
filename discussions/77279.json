[
  {
    "Id": "264137",
    "ThreadId": "77279",
    "Html": "<p>Sorry for being a Noob but...</p>\r\n<p>&nbsp;</p>\r\n<p>I would really like to use this DLL to read data from Excel in VB.Net 2008.</p>\r\n<p>&nbsp;</p>\r\n<p>I have copied the DLLs to the project directory and added a reference to them in the Project properties.And trying to follow the VB examples on this site.</p>\r\n<p>&nbsp;</p>\r\n<p>(What is the difference between the ones in the main folder in the ZIP file and the ones in the CF folder?)</p>\r\n<p>&nbsp;</p>\r\n<p>I get these errors on compile</p>\r\n<p>&nbsp;</p>\r\n<p>Error&nbsp;&nbsp; &nbsp;1&nbsp;&nbsp; &nbsp;Type 'IExcelDataReader' is not defined.&nbsp;&nbsp; &nbsp;C:\\Users\\john\\Documents\\Visual Studio 2008\\Projects\\ReadExcel\\ReadExcel\\Form1.vb&nbsp;&nbsp; &nbsp;34&nbsp;&nbsp; &nbsp;28&nbsp;&nbsp; &nbsp;ReadExcel<br>Error&nbsp;&nbsp; &nbsp;2&nbsp;&nbsp; &nbsp;Name 'Factory' is not declared.&nbsp;&nbsp; &nbsp;C:\\Users\\john\\Documents\\Visual Studio 2008\\Projects\\ReadExcel\\ReadExcel\\Form1.vb&nbsp;&nbsp; &nbsp;37&nbsp;&nbsp; &nbsp;27&nbsp;&nbsp; &nbsp;ReadExcel<br>Error&nbsp;&nbsp; &nbsp;3&nbsp;&nbsp; &nbsp;Name 'ExcelFileType' is not declared.&nbsp;&nbsp; &nbsp;C:\\Users\\john\\Documents\\Visual Studio 2008\\Projects\\ReadExcel\\ReadExcel\\Form1.vb&nbsp;&nbsp; &nbsp;37&nbsp;&nbsp; &nbsp;56&nbsp;&nbsp; &nbsp;ReadExcel<br>Error&nbsp;&nbsp; &nbsp;4&nbsp;&nbsp; &nbsp;Name 'Factory' is not declared.&nbsp;&nbsp; &nbsp;C:\\Users\\john\\Documents\\Visual Studio 2008\\Projects\\ReadExcel\\ReadExcel\\Form1.vb&nbsp;&nbsp; &nbsp;39&nbsp;&nbsp; &nbsp;27&nbsp;&nbsp; &nbsp;ReadExcel<br>Error&nbsp;&nbsp; &nbsp;5&nbsp;&nbsp; &nbsp;Name 'ExcelFileType' is not declared.&nbsp;&nbsp; &nbsp;C:\\Users\\john\\Documents\\Visual Studio 2008\\Projects\\ReadExcel\\ReadExcel\\Form1.vb&nbsp;&nbsp; &nbsp;39&nbsp;&nbsp; &nbsp;56&nbsp;&nbsp; &nbsp;ReadExcel<br>Error&nbsp;&nbsp; &nbsp;6&nbsp;&nbsp; &nbsp;Local variable 'ds' is already declared in the current block.&nbsp;&nbsp; &nbsp;C:\\Users\\john\\Documents\\Visual Studio 2008\\Projects\\ReadExcel\\ReadExcel\\Form1.vb&nbsp;&nbsp; &nbsp;68&nbsp;&nbsp; &nbsp;13&nbsp;&nbsp; &nbsp;ReadExcel</p>\r\n<p>&nbsp;</p>\r\n<p>Code</p>\r\n<p>&nbsp;</p>\r\n<p>Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Load spreadsheet file from specified format.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim stream As FileStream = File.Open(OpenFileDialog1.FileName, FileMode.Open, FileAccess.Read)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim excelreader As IExcelDataReader<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Microsoft.VisualBasic.Right(OpenFileDialog1.FileName, 5) = &quot;.xlsx&quot; Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; excelreader = Factory.CreateReader(stream, ExcelFileType.OpenXml)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; excelreader = Factory.CreateReader(stream, ExcelFileType.Binary)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim ds As DataSet = excelreader.AsDataSet<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Reads only two worksheets<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Do While excelreader.NextResult<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Do While excelreader.Read<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Dim res As String = String.Empty<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Dim objs() As Object<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Dim objcount As Int32 = excelreader.GetValues(objs)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' For i As Int32 = 0 To objcount - 1<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' res &amp;= String.Format(&quot;{0}, &quot;, objs(i))<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Next<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Debug.Print(res)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Loop<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Loop<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim ds As DataSet = excelreader.AsDataSet<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each tbl As System.Data.DataTable In ds.Tables<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each row As DataRow In tbl.Rows<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim res As String = String.Empty<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For i As Int32 = 0 To row.ItemArray.Length - 1<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; res &amp;= String.Format(&quot;{0}, &quot;, row.ItemArray(i))<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print(res)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<br><br><br>&nbsp;&nbsp;&nbsp; End Sub</p>\r\n<p>&nbsp;</p>\r\n<p>Any idea what I am doing wrong.</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks in advance. John</p>",
    "PostedDate": "2009-12-06T06:56:36.537-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]