[
  {
    "Id": "813441",
    "ThreadId": "349441",
    "Html": "\r\n<p>I have used this tool for reading Excel and Validate data.</p>\r\n<p>The problem is unable to read excel file which are exported from another page.</p>\r\n<p>There is a functionality to export excel from c# .net and I have written follwoing code.</p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"></p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;string fileName = &quot;Test.xls&quot;;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;#region Clean up Response Object<br>\r\n&nbsp;Response.Clear();<br>\r\n&nbsp;Response.Buffer = true;<br>\r\n&nbsp;Response.ClearHeaders();<br>\r\n&nbsp;Response.ClearContent();<br>\r\n&nbsp;Response.Charset = &quot;&quot;;<br>\r\n&nbsp;Response.ContentEncoding = System.Text.Encoding.Default;<br>\r\n&nbsp;#endregion</p>\r\n<p>&nbsp;#region Set the response mime type for excel<br>\r\n&nbsp;&nbsp; Response.AddHeader(&quot;content-disposition&quot;, string.Format(&quot;attachment; filename={0}.xls&quot;, fileName));<br>\r\n&nbsp;&nbsp; Response.ContentType = &quot;application/vnd.xls;charset=utf-8&quot;;//&quot;application/ms-excel&quot;;<br>\r\n&nbsp;#endregion</p>\r\n<p>&nbsp; #region Create a string writer<br>\r\n&nbsp;&nbsp;&nbsp; using (StringWriter sw = new StringWriter())<br>\r\n&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (HtmlTextWriter htw = new HtmlTextWriter(sw))<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // instantiate a datagrid&nbsp;&nbsp;\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GridView gvTreatmentResults = new GridView();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gvTreatmentResults.DataSource = this.resultsDS.Tables[0];<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gvTreatmentResults.DataBind();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gvTreatmentResults.RenderControl(htw);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Write(sw.ToString());<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.End();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;#endregion</p>\r\n</span></span>\r\n<p></p>\r\n<p></p>\r\n<div><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">&nbsp;After then , I tried to upload expored file, but was not able to read. ExcelDatareader object is not null, but all properties are null. IsValid and Read() and ASDataSet().</span></span></p>\r\n</span></span>\r\n<p>Can you please do the needful. As I have to complete it on trgent basis.</p>\r\n<p><span style=\"font-size:x-small\"></span>&nbsp;</p>\r\n</span></span></div>\r\n<p></p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"></p>\r\n<p><span style=\"font-size:x-small\"></span>Thanks in Advance.</p>\r\n</span></span>\r\n<p></p>\r\n",
    "PostedDate": "2012-03-21T04:23:59.693-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]