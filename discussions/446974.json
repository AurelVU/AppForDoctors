[
  {
    "Id": "1056442",
    "ThreadId": "446974",
    "Html": "Hello I have following bit of code used with the excel/csv sheets to import. I am using code plex excel dll for this purpose.<br />\n<pre><code>        Dim _stream As FileStream = File.Open(Server.MapPath(&quot;~/admin/DBDesigner/tempImportFolder/&quot; &amp; Fname),                            FileMode.Open, FileAccess.Read, FileShare.ReadWrite)\n      Dim excelReader As IExcelDataReader = ExcelReaderFactory.CreateBinaryReader(_stream)\n      excelReader.IsFirstRowAsColumnNames = FirstRowCols\n      Dim dtTemp As DataTable = excelReader.AsDataSet().Tables(0)\n\n</code></pre>\n\nWhen the control is coming to last line of the code it is throwing the exception <br />\n<br />\n--&gt;object reference not set to an instance of an object<br />\n<br />\nPlease help me out <br />\n<br />\nThanks in advance<br />\n",
    "PostedDate": "2013-06-13T08:45:15.98-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1056457",
    "ThreadId": "446974",
    "Html": "excelReader looks good because it has a property set on the line before, that only leaves .Tables(0) as the candidate for null.\r<br />\n<br />\nCan you check\r<br />\n Tables isnot nothing\r<br />\nand also\r<br />\n tables.count\r<br />\n<br />\nThen go through the tables returned and check if each element is not null.\r<br />\n<br />\nCan't see without a sample document really, but it might be that the first set of tables or sheet is just missing.<br />\n",
    "PostedDate": "2013-06-13T09:20:40.81-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1056462",
    "ThreadId": "446974",
    "Html": "You might want to try the equivalent of:<br />\n<pre><code>        foreach (DataTable sheet in ds.Tables)\n        {\n</code></pre>\n\nAnd see what tables you get or if you still get errors.<br />\n",
    "PostedDate": "2013-06-13T09:31:10.067-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1056706",
    "ThreadId": "446974",
    "Html": "Hi Ryan and Steve,\r<br />\n<br />\nThanks for the reply. \r<br />\n<br />\nActually my excel sheet is having the data in it and even it is throwing the same exception.\r<br />\n<br />\n<br />\nThanks for the help<br />\n",
    "PostedDate": "2013-06-14T00:32:07.86-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1056727",
    "ThreadId": "446974",
    "Html": "Can you post the full stack trace?<br />\n",
    "PostedDate": "2013-06-14T01:17:00.723-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1132513",
    "ThreadId": "446974",
    "Html": "I had the same problem.  My Excel spreadsheet was corrupt even though it opened in Excel after I received the &quot;Excel cannot open the file [filename] because the file format or file extension is not valid.&quot; message.  I resaved the file and no more errors.  <br />\n",
    "PostedDate": "2013-12-06T07:36:27.543-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1226040",
    "ThreadId": "446974",
    "Html": "Hi, I am facing issue with reading .xls and .xlsx file. It does work in my local machine. But, when published to QA box it throws the below error. Did anyone came across this issue ? I have pasted below the error stack trace for the reference.<br />\n<br />\nMy code :<br />\n<br />\nFileOperation.FileStream stream = FileOperation.File.Open(path, FileOperation.FileMode.Open, FileOperation.FileAccess.ReadWrite);<br />\n<pre><code>        IExcelDataReader excelReader = null;\n\n        if (fileType.FileExtension == &quot;xls&quot; &amp;&amp; new List&lt;string&gt;() { &quot;application/excel&quot;, &quot;application/vnd.ms-excel&quot;, &quot;application/x-excel&quot;, &quot;application/x-msexcel&quot; }.Contains(fileType.FileMimeType))\n        {\n            excelReader = ExcelReaderFactory.CreateBinaryReader(stream);\n        }\n        else if (fileType.FileExtension == &quot;xlsx&quot; &amp;&amp; fileType.FileMimeType == &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;)\n        {\n            excelReader = ExcelReaderFactory.CreateOpenXmlReader(stream);\n        }\n\n        excelReader.IsFirstRowAsColumnNames = false;\n\n        List&lt;FeeScheduleLine&gt; feeScheduleLines = new List&lt;FeeScheduleLine&gt;();\n\n        while (excelReader.Read())\n        {\n\n        }\n</code></pre>\n\nThanks in advance.<br />\n<br />\n<br />\n &lt;b&gt;Stack Trace:&lt;/b&gt; &lt;br&gt;&lt;br&gt;<br />\n<pre><code>        &lt;table width=100% bgcolor=&quot;#ffffcc&quot;&gt;\n           &lt;tr&gt;\n              &lt;td&gt;\n                  &lt;code&gt;&lt;pre&gt;\n</code></pre>\n\n[NullReferenceException: Object reference not set to an instance of an object.]<br />\n   Emds.UI.Razor.Areas.Bill.Controllers.FeeScheduleController.ReadExcelFile(String path, FileType fileType) in e:\\workspace\\CreateDailyCode_PM_NavTest\\MiddleTier\\Razor\\Emds.UI.Razor\\Areas\\Bill\\Controllers\\FeeScheduleController.cs:616<br />\n   Emds.UI.Razor.Areas.Bill.Controllers.FeeScheduleController.UploadFile() in e:\\workspace\\CreateDailyCode_PM_NavTest\\MiddleTier\\Razor\\Emds.UI.Razor\\Areas\\Bill\\Controllers\\FeeScheduleController.cs:470<br />\n   lambda_method(Closure , ControllerBase , Object[] ) +62<br />\n   System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +14<br />\n   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary<code>2 parameters) +214<br />   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary</code>2 parameters) +27<br />\n   System.Web.Mvc.&lt;&gt;c__DisplayClass15.&lt;InvokeActionMethodWithFilters&gt;b__12() +55<br />\n   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func<code>1 continuation) +253<br />   System.Web.Mvc.&amp;lt;&amp;gt;c__DisplayClass17.&amp;lt;InvokeActionMethodWithFilters&amp;gt;b__14() +21<br />   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func</code>1 continuation) +253<br />\n   System.Web.Mvc.&lt;&gt;c__DisplayClass17.&lt;InvokeActionMethodWithFilters&gt;b__14() +21<br />\n   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList<code>1 filters, ActionDescriptor actionDescriptor, IDictionary</code>2 parameters) +191<br />\n   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +324<br />\n   System.Web.Mvc.Controller.ExecuteCore() +106<br />\n   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +91<br />\n   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10<br />\n   System.Web.Mvc.&lt;&gt;c__DisplayClassb.&lt;BeginProcessRequest&gt;b__5() +34<br />\n   System.Web.Mvc.Async.&lt;&gt;c__DisplayClass1.&lt;MakeVoidDelegate&gt;b__0() +19<br />\n   System.Web.Mvc.Async.&lt;&gt;c__DisplayClass8<code>1.&amp;lt;BeginSynchronous&amp;gt;b__7(IAsyncResult _) +10<br /><br />   System.Web.Mvc.Async.WrappedAsyncResult</code>1.End() +62<br />\n   System.Web.Mvc.&lt;&gt;c__DisplayClasse.&lt;EndProcessRequest&gt;b__d() +48<br />\n   System.Web.Mvc.SecurityUtil.&lt;GetCallInAppTrustThunk&gt;b__0(Action f) +7<br />\n   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22<br />\n   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60<br />\n   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9<br />\n<br />\n   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +9514928<br />\n<br />\n   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +155<br />\n&lt;/pre&gt;&lt;/code&gt;<br />\n<pre><code>              &lt;/td&gt;\n           &lt;/tr&gt;\n        &lt;/table&gt;\n\n        &lt;br&gt;\n\n        &lt;hr width=100% size=1 color=silver&gt;\n\n        &lt;b&gt;Version Information:&lt;/b&gt;&amp;nbsp;Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.18446\n\n        &lt;/font&gt;\n\n&lt;/body&gt;</code></pre>\n\n&lt;/html&gt;<br />\n&lt;!-- \n[NullReferenceException]: Object reference not set to an instance of an object.\n   at Emds.UI.Razor.Areas.Bill.Controllers.FeeScheduleController.ReadExcelFile(String path, FileType fileType) in e:\\workspace\\CreateDailyCode_PM_NavTest\\MiddleTier\\Razor\\Emds.UI.Razor\\Areas\\Bill\\Controllers\\FeeScheduleController.cs:line 616\n   at Emds.UI.Razor.Areas.Bill.Controllers.FeeScheduleController.UploadFile() in e:\\workspace\\CreateDailyCode_PM_NavTest\\MiddleTier\\Razor\\Emds.UI.Razor\\Areas\\Bill\\Controllers\\FeeScheduleController.cs:line 470\n   at lambda_method(Closure , ControllerBase , Object[] )\n   at System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)\n\n   at System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)\n   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)\n   at System.Web.Mvc.ControllerActionInvoker.&lt;&gt;c__DisplayClass15.&lt;InvokeActionMethodWithFilters&gt;b__12()\n   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)\n   at System.Web.Mvc.ControllerActionInvoker.&lt;&gt;c__DisplayClass15.&lt;&gt;c__DisplayClass17.&lt;InvokeActionMethodWithFilters&gt;b__14()\n   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)\n   at System.Web.Mvc.ControllerActionInvoker.&lt;&gt;c__DisplayClass15.&lt;&gt;c__DisplayClass17.&lt;InvokeActionMethodWithFilters&gt;b__14()\n   at System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters)\n   at System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName)\n   at System.Web.Mvc.Controller.ExecuteCore()\n   at System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext)\n   at System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext)\n   at System.Web.Mvc.MvcHandler.&lt;&gt;c__DisplayClass6.&lt;&gt;c__DisplayClassb.&lt;BeginProcessRequest&gt;b__5()\n   at System.Web.Mvc.Async.AsyncResultWrapper.&lt;&gt;c__DisplayClass1.&lt;MakeVoidDelegate&gt;b__0()\n   at System.Web.Mvc.Async.AsyncResultWrapper.&lt;&gt;c__DisplayClass8`1.&lt;BeginSynchronous&gt;b__7(IAsyncResult _)\n   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End()\n   at System.Web.Mvc.MvcHandler.&lt;&gt;c__DisplayClasse.&lt;EndProcessRequest&gt;b__d()\n   at System.Web.Mvc.SecurityUtil.&lt;GetCallInAppTrustThunk&gt;b__0(Action f)\n   at System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action)\n   at System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult)\n   at System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result)\n\n   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()\n   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously)\n--&gt;&lt;!-- \nThis error page might contain sensitive information because ASP.NET is configured to show verbose error messages using &amp;lt;customErrors mode=&quot;Off&quot;/&amp;gt;. Consider using &amp;lt;customErrors mode=&quot;On&quot;/&amp;gt; or &amp;lt;customErrors mode=&quot;RemoteOnly&quot;/&amp;gt; in production environments.--&gt;",
    "PostedDate": "2014-03-24T08:27:31.627-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]