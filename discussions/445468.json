[
  {
    "Id": "1050656",
    "ThreadId": "445468",
    "Html": "Hi,\r<br />\n<br />\nI have an Excel file (<strong>xlsx</strong>), generated by an external software that gives me the following error when I try to open it using <strong>createxmlreader</strong>.\r<br />\n<br />\nThe file opens perfectly in Excel. When I open it in Excel and resave it, the file works ok, any <strong>hint</strong>?\r<br />\n<br />\n<strong>System.ArgumentNullException</strong>: Value cannot be null.\r<br />\nParameter name: String\r<br />\n   at System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer&amp; number, NumberFormatInfo info, Boolean parseDecimal)\r<br />\n   at System.Number.ParseInt32(String s, NumberStyles style, NumberFormatInfo info)\r<br />\n   at Excel.Core.OpenXmlFormat.XlsxWorkbook.ReadStyles(Stream xmlFileStream) in\r<br />\nc:\\development\\eapidemo\\third-party\\ExcelDataReader\\ExcelDataReader\\Excel\\Core\\OpenXmlFormat\\XlsxWorkbook.cs:line 103\r<br />\n   at Excel.ExcelOpenXmlReader.ReadGlobals() in c:\\development\\eapidemo\\third-party\\ExcelDataReader\\ExcelDataReader\\Excel\\ExcelOpenXmlReader.cs:line 56\r<br />\n   at Excel.ExcelReaderFactory.CreateOpenXmlReader(Stream fileStream) in c:\\development\\eapidemo\\third-party\\ExcelDataReader\\ExcelDataReader\\Excel\\ExcelReaderFa\r<br />\nctory.cs:line 37<br />\n<h2>   at ConsoleApplication2.Program.Main(String[] args) in C:\\Users\\jcarneiro\\Documents\\Visual Studio 2005\\Projects\\ConsoleApplication2\\ConsoleApplication2\\Program.cs:line 22</h2>\nI'm trying to open it in a small console application that just reads and shows the contents of the file.\r<br />\n<br />\nusing System;\r<br />\nusing System.Data;\r<br />\nusing System.IO;\r<br />\nusing Excel;\r<br />\n<br />\nnamespace ConsoleApplication2\r<br />\n{<br />\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        //string filePath = args[0];\n        string filePath = &quot;c://Excel Tester//Facturas_20130527.xlsx&quot;;\n        FileStream fileStream = new FileStream(\n            filePath,\n            FileMode.Open,\n            FileAccess.Read,\n            FileShare.ReadWrite);\n        try\n        {\n            IExcelDataReader excelReader = filePath.ToLower().EndsWith(&quot;xls&quot;)\n                                               ? ExcelReaderFactory.CreateBinaryReader(fileStream)\n                                               : ExcelReaderFactory.CreateOpenXmlReader(fileStream);\n            DataSet result = excelReader.AsDataSet();\n            int lineNumber = 1;\n            while (++lineNumber &lt; result.Tables[0].Rows.Count)\n            {\n                foreach (\n                    string s in\n                        Array.ConvertAll&lt;object, string&gt;(result.Tables[0].Rows[lineNumber].ItemArray,\n                                                         Convert.ToString))\n                {\n                    Console.Write(s + &quot;\\t&quot;);\n                }\n                Console.Write(&quot;\\n&quot;);\n            }\n        }\n        catch(Exception e)\n        {\n            Console.WriteLine(&quot;Error - &quot;+e);\n        }\n        Console.WriteLine(&quot;Press any key...&quot;);\n        Console.Read();\n    }\n}</code></pre>\n\n}<br />\n",
    "PostedDate": "2013-05-30T07:59:34.94-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]