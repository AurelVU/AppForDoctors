[
  {
    "Id": "231590",
    "ThreadId": "68092",
    "Html": "<p>hi, i am newbie,</p>\r\n<p>this is my pgm.</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OpenFileDialog1.InitialDirectory = &quot;C:\\&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OpenFileDialog1.Filter = &quot;Excel 97-2003 (*.xls)|*.xls|Excel 2007 (*.xlsx)&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OpenFileDialog1.FileName = &quot;&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OpenFileDialog1.FilterIndex = 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim dlgOpenFile As New OpenFileDialog<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim strFileName As String<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If OpenFileDialog1.ShowDialog = DialogResult.OK Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strFileName = OpenFileDialog1.FileName()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim stream As FileStream = File.Open(strFileName, FileMode.Open, FileAccess.Read)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim excelReader As IExcelDataReader<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Load spreadsheet file from specified format.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Case OpenFileDialog1.FilterIndex<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '1. Reading from a binary Excel file ('97-2003 format; *.xls)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; excelReader = ExcelReaderFactory.CreateBinaryReader(stream)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Select<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case 2<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '2. Reading from a OpenXml Excel file (2007 format; *.xlsx)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; excelReader = ExcelReaderFactory.CreateOpenXmlReader(stream)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit Select<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Select<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '3. DataSet - The result of each spreadsheet will be created in the result.Tables<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim result As DataSet = excelReader.AsDataSet()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '4. DataSet - Create column names from first row<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; excelReader.IsFirstRowAsColumnNames = True<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '5. Data Reader methods<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While excelReader.Read()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' excelReader.GetInt32(0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox(result.Tables.Item(0).ToString)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox(excelReader.Item(10) &amp; &quot;&nbsp; -&nbsp; &quot; &amp; excelReader.Item(11) &amp; &quot;&nbsp; -&nbsp; &quot; &amp; excelReader.Item(12))<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End While<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '6. Free resources (IExcelDataReader is IDisposable)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; excelReader.Close()</p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"color:#0000ff\">i don't know how to read the worksheets, although i got the result from this &quot;excelReader.Item(10)&quot;</span></p>\r\n<p><span style=\"color:#0000ff\">1.&nbsp; can&nbsp; i read cells(A2) directly?</span></p>\r\n<p><span style=\"color:#0000ff\">2. is there any readnext rows functions just like adodb .movenext??</span></p>\r\n<p><span style=\"color:#0000ff\">3. does it support sql statement?</span></p>\r\n<p>&nbsp;</p>\r\n<p>thank you</p>",
    "PostedDate": "2009-09-06T08:29:35.927-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "232227",
    "ThreadId": "68092",
    "Html": "<p>\r\n<p>\r\n<p>&nbsp;</p>\r\n</p>\r\n</p>\r\n<p>If OpenFileDialog1.ShowDialog() = Windows.Forms.DialogResult.OK Then</p>\r\n<p>Dim stream As FileStream = File.Open(OpenFileDialog1.FileName, FileMode.Open, FileAccess.Read)</p>\r\n<p>Dim excelreader As IExcelDataReader</p>\r\n<p>If Microsoft.VisualBasic.Right(OpenFileDialog1.FileName, 5) = &quot;.xlsx&quot; Then</p>\r\n<p>excelreader = Factory.CreateReader(stream, ExcelFileType.OpenXml)</p>\r\n<p>Else</p>\r\n<p>excelreader = Factory.CreateReader(stream, ExcelFileType.Binary)</p>\r\n<p>End If</p>\r\n<p>'Dim ds As DataSet = excelreader.AsDataSet</p>\r\n<p>'Reads only two worksheets</p>\r\n<p>'Do While excelreader.NextResult</p>\r\n<p>' Do While excelreader.Read</p>\r\n<p>' Dim res As String = String.Empty</p>\r\n<p>' Dim objs() As Object</p>\r\n<p>' Dim objcount As Int32 = excelreader.GetValues(objs)</p>\r\n<p>' For i As Int32 = 0 To objcount - 1</p>\r\n<p>' res &amp;= String.Format(&quot;{0}, &quot;, objs(i))</p>\r\n<p>' Next</p>\r\n<p>' Debug.Print(res)</p>\r\n<p>' Loop</p>\r\n<p>'Loop</p>\r\n<p>Dim ds As DataSet = excelreader.AsDataSet</p>\r\n<p>For Each tbl As System.Data.DataTable In ds.Tables</p>\r\n<p>For Each row As DataRow In tbl.Rows</p>\r\n<p>Dim res As String = String.Empty</p>\r\n<p>For i As Int32 = 0 To row.ItemArray.Length - 1</p>\r\n<p>res &amp;= String.Format(&quot;{0}, &quot;, row.ItemArray(i))</p>\r\n<p>Next</p>\r\n<p>Debug.Print(res)</p>\r\n<p>Next</p>\r\n<p>Next</p>\r\n<p>End If</p>",
    "PostedDate": "2009-09-08T07:34:06.283-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "233809",
    "ThreadId": "68092",
    "Html": "<p>thank you gdj,</p>\r\n<p>your code provided read all data from spreadsheet, good.</p>\r\n<p>Is it a method to read select rows of data and selected column of data like &quot;SQL statement&quot;?</p>\r\n<p>I am now using the oledb connection from this excelreader. :(</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-09-11T19:21:45.613-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]